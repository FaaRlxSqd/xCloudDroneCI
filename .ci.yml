--- 
clone: 
  depth: 1
kind: pipeline
name: RyuuPipeline
concurrency:
  limit: 6
steps: 
  - 
    environment:
     KERNEL_NAME:
       from_secret: KERNEL_NAME
     KERNEL_SOURCE:
       from_secret: KERNEL_SOURCE
     KERNEL_BRANCH:
       from_secret: KERNEL_BRANCH
     DEVICE_CODENAME:
       from_secret: DEVICE_CODENAME
     DEVICE_DEFCONFIG:
       from_secret: DEVICE_DEFCONFIG
     ANYKERNEL:
       from_secret: ANYKERNEL
     TG_TOKEN:
       from_secret: TG_TOKEN
     TG_CHAT_ID:
       from_secret: TG_CHAT_ID
     BUILD_USER:
       from_secret: BUILD_USER
     BUILD_HOST:
       from_secret: BUILD_HOST
    image: archlinux:base-devel
    name: RyuujiX-Build
    commands: 
      - curl -LO "https://repo.archlinuxcn.org/x86_64/glibc-linux4-2.33-4-x86_64.pkg.tar.zst" && bsdtar -C / -xvf "glibc-linux4-2.33-4-x86_64.pkg.tar.zst"
      - pacman -Sy && pacman -S git bc inetutils python3 flex bison libc++ libxml2 python-pip zip wget cpio jdk-openjdk tzdata --noconfirm
      - ln -s /usr/share/zoneinfo/Asia/Jakarta /etc/localtime && date
      - bash kernel_build.sh
